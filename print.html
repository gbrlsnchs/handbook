<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js dark">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Gabriel Sanches's Handbook</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="theme/light.css">
        
        <link rel="stylesheet" href="theme/dark.css">
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="about.html">This handbook</a></li><li class="chapter-item expanded affix "><li class="part-title">Distros</li><li class="chapter-item expanded "><a href="void-linux/ch-00-index.html"><strong aria-hidden="true">1.</strong> Void Linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="void-linux/ch-01-00-introduction.html"><strong aria-hidden="true">1.1.</strong> Installing Void</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="void-linux/ch-01-01-live-iso.html"><strong aria-hidden="true">1.1.1.</strong> Live ISO</a></li><li class="chapter-item expanded "><a href="void-linux/ch-01-02-formatting-disks.html"><strong aria-hidden="true">1.1.2.</strong> Formatting disks</a></li><li class="chapter-item expanded "><a href="void-linux/ch-01-03-installing-the-system.html"><strong aria-hidden="true">1.1.3.</strong> Installing the system</a></li><li class="chapter-item expanded "><a href="void-linux/ch-01-04-inside-the-chroot-jail.html"><strong aria-hidden="true">1.1.4.</strong> Inside the chroot jail</a></li><li class="chapter-item expanded "><a href="void-linux/ch-01-05-finishing-installation.html"><strong aria-hidden="true">1.1.5.</strong> Finishing installation</a></li></ol></li><li class="chapter-item expanded "><a href="void-linux/ch-02-00-introduction.html"><strong aria-hidden="true">1.2.</strong> Post-installation</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark (default)</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Gabriel Sanches's Handbook</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="this-handbook"><a class="header" href="#this-handbook">This handbook</a></h1>
<h2 id="about"><a class="header" href="#about">About</a></h2>
<p>This book is a compilation of tech-related stuff I consider important and somewhat hard to keep in
memory for ever. Also, part of this knowledge comes from trial and error, therefore it might be
useful for some folks around looking for specific solutions.</p>
<h2 id="how"><a class="header" href="#how">How</a></h2>
<p>This book is built with <a href="https://rust-lang.github.io/mdBook/">mdBook</a>. You can check the source code
<a href="https://github.com/gbrlsnchs/handbook">here</a>.</p>
<h1 id="void-linux"><a class="header" href="#void-linux">Void Linux</a></h1>
<p>Void is a stable rolling release, systemd-free Linux distribution with a powerful package manager
called XBPS. I use as the Linux distro for my main programming workstation. You can check more
information about Void on <a href="https://voidlinux.org/">the official website</a>.</p>
<h2 id="why"><a class="header" href="#why">Why</a></h2>
<p>The first thing some people ask is why use Void and not Ubuntu (for its supposed simplicity), or
even Arch (for rolling release).</p>
<p>Well, I use Void because I value <strong>minimalism</strong> and <strong>control</strong> over as much features of my machine
it is possible. Ubuntu is far from being minimalist and Arch abstracts too many functionalities to
the systemd suite.</p>
<h2 id="this-chapter"><a class="header" href="#this-chapter">This chapter</a></h2>
<p>Having my reasonings behind picking Void being clarified, take note that configuring and maintaining
it requires some effort, but at the end of the day it totally pays off because you end up learning
many aspects of the system and how Linux and other useful tools work in general.</p>
<p>Since such knowledge doesn't stick to the brain forever, this chapter is an ever-changing
compilation about everything I struggled through regarding Void, in order to help people that are
interested in using it.</p>
<h1 id="installing-void"><a class="header" href="#installing-void">Installing Void</a></h1>
<p>In this guide you will learn how to get a working installation of Void containing:</p>
<ul>
<li>btrfs with Zstandard compression</li>
<li>LUKS-encrypted root and swapfile</li>
<li>GRUB with UEFI</li>
</ul>
<p>Things you will <strong>not</strong> find in this handbook:</p>
<ul>
<li>Instructions for file systems other than btrfs</li>
<li>Full disk encryption (there's an official guide
<a href="https://docs.voidlinux.org/installation/guides/fde.html">here</a>)</li>
<li>Reasoning for all choices I've made (sometimes I don't know the true reason behind my choices)</li>
</ul>
<h1 id="live-iso"><a class="header" href="#live-iso">Live ISO</a></h1>
<p>For this tutorial, you'll need to download the <em>base</em> image from Void's official download page,
which can be found <a href="https://voidlinux.org/download/">here</a>. You'll have to choose between the
<em>glibc</em> one and the <em>musl</em> one.</p>
<p>One question people make often is why the live ISO image is &quot;not up-to-date&quot;. Void is a <em>rolling
release</em> distro. It's different from Ubuntu, which has release cycles. Software in Void is
constantly getting updated, so regardless of how old the image is, you'll end up downloading and
installing the most recent packages there exists in the Void repos.</p>
<blockquote>
<p><strong>Note:</strong> A possible issue in old live ISO images is lack of support for most recent hardware.
This is uncommon to happen, but if it does, resort to official channels for help.</p>
</blockquote>
<h2 id="logging-in"><a class="header" href="#logging-in">Logging in</a></h2>
<p>There are two available users, <code>root</code> (superuser) and <code>anon</code>. The password of both is <code>voidlinux</code>
(it might vary from image to image, but it's always explict in the starting screen). I prefer to log
in as superuser so I don't have to type <code>sudo</code> all the time. Also, I highly recommend that you run
<code>exec bash</code> since it is a little more comfortable to work with than <code>dash</code>, the default shell for
the live ISO image.</p>
<h2 id="configuring-keyboard-layout"><a class="header" href="#configuring-keyboard-layout">Configuring keyboard layout</a></h2>
<p>If you need a different layout other than <code>en_US</code> during the install process, you can change it
using <code>loadkeys</code>, for example:</p>
<pre><code class="language-console"># loadkeys $(ls /usr/share/kbd/keymaps/i386/**/*.map.gz | grep br-abnt2)
</code></pre>
<h2 id="connecting-to-the-internet"><a class="header" href="#connecting-to-the-internet">Connecting to the internet</a></h2>
<p>If you're connect via ethernet, you're good to go, since the live ISO image already runs the DHCP
service by default. However, if you're on Wi-Fi, you'll need additional setup. For example, to
configure it for interface <code>wlan0</code>:</p>
<pre><code class="language-console"># cp /etc/wpa_supplicant/wpa_supplicant.conf /etc/wpa_supplicant/wpa_supplicant-wlan0.conf
# wpa_passphrase $SSID $PASS &gt;&gt; /etc/wpa_supplicant/wpa_supplicant-wlan0.conf
# ip link set up wlan0
# sv restart dhcpcd
</code></pre>
<h1 id="formatting-disks"><a class="header" href="#formatting-disks">Formatting disks</a></h1>
<h2 id="partitioning"><a class="header" href="#partitioning">Partitioning</a></h2>
<p>The minimum number of partitions is three:</p>
<ul>
<li>The EFI partition, where the GRUB bootloader resides (<code>/efi</code>)</li>
<li>The boot partition, where kernels are stored (<code>/boot</code>)</li>
<li>The LUKS-encrypted btrfs root partition</li>
</ul>
<p>First, we need to generate the partition tables. Let's set the disk up:</p>
<pre><code class="language-console"># fdisk /dev/sda
</code></pre>
<blockquote>
<p><strong>Note:</strong> Check which device is the one you want to install Void into. For this guide I'll simply
use <code>/dev/sda</code>, but it can change depending on your setup, so <em>watch out!</em></p>
</blockquote>
<p>After running <code>fdisk</code>, it will prompt you with a menu, so follow these steps:</p>
<ol>
<li>Press <kbd>g</kbd> and then <kbd>Enter</kbd> to generate a GPT table</li>
<li>Press <kbd>n</kbd> and then <kbd>Enter</kbd> to create the EFI partition with size of 200 MiB
(<code>+200M</code>)</li>
<li>After creating the partition, change its type by pressing <kbd>t</kbd> and then <kbd>Enter</kbd>
and select the option that represents the EFI partition (usually 1)</li>
<li>Press <kbd>n</kbd> and then <kbd>Enter</kbd> to create the boot partition with size of at least
500 MiB (<code>+500M</code>)</li>
<li>If the default partition type selected for the root partition is not already <code>Linux Filesystem</code>,
change it by pressing <kbd>t</kbd> and then selecting it (usually 20)</li>
</ol>
<h2 id="creating-the-file-systems"><a class="header" href="#creating-the-file-systems">Creating the file systems</a></h2>
<h3 id="efi-partition"><a class="header" href="#efi-partition">EFI partition</a></h3>
<pre><code class="language-console"># mkfs.vfat -nBOOT -F32 /dev/sda1
</code></pre>
<h3 id="boot-partition"><a class="header" href="#boot-partition">Boot partition</a></h3>
<pre><code class="language-console"># mkfs.ext2 -L grub /dev/sda2
</code></pre>
<h3 id="luks-encrypted-root-partition"><a class="header" href="#luks-encrypted-root-partition">LUKS-encrypted root partition</a></h3>
<pre><code class="language-console"># cryptsetup luksFormat --type=luks -s=512 /dev/sda3
# cryptsetup open /dev/sda3 cryptroot
# mkfs.btrfs -L void /dev/mapper/cryptroot
</code></pre>
<h2 id="mounting"><a class="header" href="#mounting">Mounting</a></h2>
<p>Now that the file systems have been created, it's time to mount them.</p>
<h3 id="root-partition"><a class="header" href="#root-partition">Root partition</a></h3>
<p>For the root partition, it is necessary to first create <em>top-level subvolumes</em>:</p>
<pre><code class="language-console"># BTRFS_OPTS=&quot;rw,noatime,ssd,compress=zstd,space_cache,commit=120&quot;
# mount -o $BTRFS_OPTS /dev/mapper/cryptroot /mnt
# btrfs subvolume create /mnt/@
# btrfs subvolume create /mnt/@home
# btrfs subvolume create /mnt/@snapshots
# umount /mnt
</code></pre>
<p>Then, proceed to mount them:</p>
<pre><code class="language-console"># mount -o $BTRFS_OPTS,subvol=@ /dev/mapper/cryptroot /mnt
# mkdir /mnt/home &amp;&amp; mount -o $BTRFS_OPTS,subvol=@home /dev/mapper/cryptroot /mnt
# mkdir /mnt/.snapshots &amp;&amp; mount -o $BTRFS_OPTS,subvol=@snapshots /dev/mapper/cryptroot /mnt
</code></pre>
<blockquote>
<p><strong>Note:</strong> Those are the options and names I like to use for btrfs. Feel free to change them
according to your needs!</p>
</blockquote>
<h3 id="extra-subvolumes"><a class="header" href="#extra-subvolumes">Extra subvolumes</a></h3>
<p>Since btrfs doesn't take snapshots of nested subvolumes, it is a good practice to create some extra,
nested subvolumes for directories that are not meant to be in the snapshots:</p>
<pre><code class="language-console"># mkdir -p /mnt/var/cache
# btrfs subvolume create /mnt/var/cache/xbps
# btrfs subvolume create /mnt/var/tmp
# btrfs subvolume create /mnt/srv
</code></pre>
<p>Also, if you're going for the swapfile, don't forget to create a nested subvolume for it:</p>
<pre><code class="language-console"># btrfs subvolume create /mnt/var/swap
</code></pre>
<blockquote>
<p><strong>Note:</strong> Nested subvolumes are mounted automatically when their parent subvolume is mounted.</p>
</blockquote>
<h3 id="efi-and-boot-partitions"><a class="header" href="#efi-and-boot-partitions">EFI and boot partitions</a></h3>
<p>Once the root partition is ready, it is time to mount the remaining ones:</p>
<pre><code class="language-console"># mkdir /mnt/efi &amp;&amp; mount -o rw,noatime /dev/sda1 /mnt/efi
# mkdir /mnt/boot &amp;&amp; mount -o rw,noatime /dev/sda2 /mnt/boot
</code></pre>
<h1 id="installing-the-system"><a class="header" href="#installing-the-system">Installing the system</a></h1>
<h2 id="base-installation"><a class="header" href="#base-installation">Base installation</a></h2>
<p>First, set some helper variables:</p>
<pre><code class="language-console"># REPO=https://alpha.us.repo.voidlinux.org/current
# ARCH=x86_64
</code></pre>
<p>If going for the <em>musl</em> variant, just reset the variables accordingly:</p>
<pre><code class="language-console"># REPO=&quot;$REPO/musl&quot;
# ARCH=&quot;$ARCH-musl&quot;
</code></pre>
<p>Then proceed to install the base system:</p>
<pre><code class="language-console"># XBPS_ARCH=$ARCH xbps-install -S -R &quot;$REPO&quot; -r /mnt base-system btrfs-progs cryptsetup
</code></pre>
<blockquote>
<p><strong>Note:</strong> The command above installs the base system (<code>base-system</code>), along with btrfs utilities
(<code>btrfs-progs</code>) and dm-crypt utilities (<code>cryptsetup</code>).</p>
</blockquote>
<h2 id="running-chroot"><a class="header" href="#running-chroot">Running <code>chroot</code></a></h2>
<p>Mount the pseudo file systems needed for chroot:</p>
<pre><code class="language-console"># for dir in dev proc sys run; do mount --rbind /$dir /mnt/$dir; mount --make-rslave /mnt/$dir; done
</code></pre>
<p>Copy the DNS configuration into the new root so that XBPS can still download new packages inside the
chroot:</p>
<pre><code class="language-console"># cp /etc/resolv.conf /mnt/etc/
</code></pre>
<p>Finally, <code>chroot</code> into the new installation:</p>
<pre><code class="language-console"># BTRFS_OPTS=$BTRFS_OPTS PS1='chroot# ' chroot /mnt/ /bin/bash
</code></pre>
<blockquote>
<p><strong>Note:</strong> The variable <code>BTRFS_OPTS</code> is passed into the chroot so we can use it later when setting
fstab (<code>/etc/fstab</code>).</p>
</blockquote>
<h1 id="inside-the-chroot-jail"><a class="header" href="#inside-the-chroot-jail">Inside the chroot jail</a></h1>
<h2 id="basic-configuration"><a class="header" href="#basic-configuration">Basic configuration</a></h2>
<h3 id="hostname"><a class="header" href="#hostname">Hostname</a></h3>
<p>Write the desired hostname to <code>/etc/hostname</code>.</p>
<h3 id="system-configuration-information"><a class="header" href="#system-configuration-information">System configuration information</a></h3>
<p>Refer to <a href="https://docs.voidlinux.org/config/rc-files.html#rcconf">this documentation</a> in order to
configure your <code>rc.conf</code> file.</p>
<h3 id="configuring-locales"><a class="header" href="#configuring-locales">Configuring locales</a></h3>
<p>For <em>glibc</em> installations, edit <code>/etc/default/libc-locales</code>, then run:</p>
<pre><code class="language-console">chroot# xbps-reconfigure -f glibc-locales
</code></pre>
<h3 id="root-password"><a class="header" href="#root-password">Root password</a></h3>
<pre><code class="language-console">chroot# passwd
</code></pre>
<h3 id="configuring-fstab"><a class="header" href="#configuring-fstab">Configuring fstab</a></h3>
<p>If you store the appropriate data before creating the fstab file, you don't even need an editor:</p>
<pre><code class="language-console">chroot# UEFI_UUID=$(blkid -s UUID -o value /dev/sda1)
chroot# GRUB_UUID=$(blkid -s UUID -o value /dev/sda2)
chroot# ROOT_UUID=$(blkid -s UUID -o value /dev/mapper/cryptoroot)
chroot# cat &lt;&lt;EOF &gt; /etc/fstab
UUID=$ROOT_UUID / btrfs $BTRFS_OPTS,subvol=@ 0 1
UUID=$UEFI_UUID /efi vfat defaults,noatime 0 2
UUID=$GRUB_UUID /boot ext2 defaults,noatime 0 2
UUID=$ROOT_UUID /home btrfs $BTRFS_OPTS,subvol=@home 0 2
UUID=$ROOT_UUID /.snapshots btrfs $BTRFS_OPTS,subvol=@snapshots 0 2
tmpfs /tmp tmpfs defaults,nosuid,nodev 0 0
EOF
</code></pre>
<h3 id="setting-up-dracut"><a class="header" href="#setting-up-dracut">Setting up Dracut</a></h3>
<p>I suggest doing a <em>hostonly</em> install, that is, Dracut  will generate a lean initramfs with
everything you might need:</p>
<pre><code class="language-console">chroot# echo hostonly=yes &gt;&gt; /etc/dracut.conf
</code></pre>
<blockquote>
<p><strong>Note:</strong> For example, with <em>hostonly</em> activated, Dracut will include i915 DRM drivers if you have
an Intel CPU with integrated graphics.</p>
</blockquote>
<h1 id="finishing-installation"><a class="header" href="#finishing-installation">Finishing installation</a></h1>
<h2 id="intel-microcode"><a class="header" href="#intel-microcode">Intel microcode</a></h2>
<pre><code class="language-console">chroot# xbps-install -Su void-repo-nonfree intel-ucode
</code></pre>
<blockquote>
<p><strong>Note:</strong> If you're using an AMD CPU, install <code>linux-firmware-amd</code> instead.</p>
</blockquote>
<h2 id="grub"><a class="header" href="#grub">GRUB</a></h2>
<pre><code class="language-console">chroot# xbps-install grub-x86_64-efi
chroot# grub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=&quot;Void Linux&quot;
</code></pre>
<h2 id="swapfile"><a class="header" href="#swapfile">Swapfile</a></h2>
<p>In order to have an encrypted swap, let's use a more clean approach by using a <em>swapfile</em> for,
<em>duh</em>, swap. For this example, I'll create a swapfile of 16 GiB, but you can choose the best size
for your installation:</p>
<pre><code class="language-console">chroot# btrfs subvolume create /var/swap
chroot# truncate -s 0 /var/swap/swapfile
chroot# chattr +C /var/swap/swapfile
chroot# btrfs property set /var/swap/swapfile compression none
chroot# chmod 600 /var/swap/swapfile
chroot# dd if=/dev/zero of=/var/swap/swapfile bs=1G count=16 status=progress
chroot# mkswap /var/swap/swapfile
chroot# swapon /var/swap/swapfile
</code></pre>
<p>Now, you'll need a tool to calculate the <code>resume_offset</code> kernel parameter for btrfs. You can either
follow <a href="https://wiki.archlinux.org/index.php/Power_management/Suspend_and_hibernate#Hibernation_into_swap_file_on_Btrfs">this guide on Arch Linux's
wiki</a>
or you can use XBPS to build <a href="https://github.com/gbrlsnchs/void-packages/tree/btrfs_map_physical">a template I maintain
myself</a> of the same code cited
in Arch's wiki.</p>
<p>After calculating the value, set it to a variable, let's say, <code>RESUME_OFFSET</code>, and append the
following to GRUB's config:</p>
<pre><code class="language-console">chroot# echo GRUB_CMDLINE_LINUX=&quot;resume=UUID=$ROOT_UUID resume_offset=$RESUME_OFFSET&quot; &gt;&gt; /etc/default/grub
</code></pre>
<blockquote>
<p><strong>Note:</strong> This won't be an issue with Void, but be aware that you need Linux kernel version 5.0+
in order to use a swapfile with btrfs.</p>
</blockquote>
<h2 id="regenerating-configurations"><a class="header" href="#regenerating-configurations">Regenerating configurations</a></h2>
<p>Finally, regenerate configurations and reboot the machine:</p>
<pre><code class="language-console">chroot# xbps-reconfigure -fa
chroot# exit
# umount -R /mnt
# shutdown -r now
</code></pre>
<h1 id="post-installation"><a class="header" href="#post-installation">Post-installation</a></h1>
<p>If everything went well in the previous chapter, your Void system has successfully booted and you
have unlocked your disk in order to be prompted with the login screen in a terminal. Since you only
have root available, the first thing to be done is <em>not</em> to be root anymore, so let's create a user
account.</p>
<h2 id="creating-the-main-user"><a class="header" href="#creating-the-main-user">Creating the main user</a></h2>
<p>Log in as root, set your username to a variable, let's say, <code>MY_USERNAME</code>, and run:</p>
<pre><code class="language-console"># xbps-install -S zsh
# useradd -m -G wheel,input,video -s /bin/zsh $MY_USERNAME
# passwd $MY_USERNAME
# visudo
</code></pre>
<p>After running <code>visudo</code>, uncomment the line that contains <code>%wheel</code>. Log out and then log in with the
newly created user.</p>
<blockquote>
<p><strong>Note:</strong> If you want to lock down the root account, you can run <code>sudo passwd -dl root</code>. Be
careful though, as you won't be able to log in using the root account anymore, so make sure your
account has root privileges with <code>sudo</code>!</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
